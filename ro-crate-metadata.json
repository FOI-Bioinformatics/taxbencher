{
    "@context": [
        "https://w3id.org/ro/crate/1.1/context",
        {
            "GithubService": "https://w3id.org/ro/terms/test#GithubService",
            "JenkinsService": "https://w3id.org/ro/terms/test#JenkinsService",
            "PlanemoEngine": "https://w3id.org/ro/terms/test#PlanemoEngine",
            "TestDefinition": "https://w3id.org/ro/terms/test#TestDefinition",
            "TestInstance": "https://w3id.org/ro/terms/test#TestInstance",
            "TestService": "https://w3id.org/ro/terms/test#TestService",
            "TestSuite": "https://w3id.org/ro/terms/test#TestSuite",
            "TravisService": "https://w3id.org/ro/terms/test#TravisService",
            "definition": "https://w3id.org/ro/terms/test#definition",
            "engineVersion": "https://w3id.org/ro/terms/test#engineVersion",
            "instance": "https://w3id.org/ro/terms/test#instance",
            "resource": "https://w3id.org/ro/terms/test#resource",
            "runsOn": "https://w3id.org/ro/terms/test#runsOn"
        }
    ],
    "@graph": [
        {
            "@id": "./",
            "@type": "Dataset",
            "creativeWorkStatus": "InProgress",
            "datePublished": "2025-10-08T13:42:47+00:00",
            "description": "# FOI-Bioinformatics/taxbencher\n\n[![GitHub Actions CI Status](https://github.com/FOI-Bioinformatics/taxbencher/actions/workflows/nf-test.yml/badge.svg)](https://github.com/FOI-Bioinformatics/taxbencher/actions/workflows/nf-test.yml)\n[![GitHub Actions Linting Status](https://github.com/FOI-Bioinformatics/taxbencher/actions/workflows/linting.yml/badge.svg)](https://github.com/FOI-Bioinformatics/taxbencher/actions/workflows/linting.yml)[![Cite with Zenodo](http://img.shields.io/badge/DOI-10.5281/zenodo.XXXXXXX-1073c8?labelColor=000000)](https://doi.org/10.5281/zenodo.XXXXXXX)\n[![nf-test](https://img.shields.io/badge/unit_tests-nf--test-337ab7.svg)](https://www.nf-test.com)\n\n[![Nextflow](https://img.shields.io/badge/version-%E2%89%A524.10.5-green?style=flat&logo=nextflow&logoColor=white&color=%230DC09D&link=https%3A%2F%2Fnextflow.io)](https://www.nextflow.io/)\n[![nf-core template version](https://img.shields.io/badge/nf--core_template-3.3.2-green?style=flat&logo=nfcore&logoColor=white&color=%2324B064&link=https%3A%2F%2Fnf-co.re)](https://github.com/nf-core/tools/releases/tag/3.3.2)\n[![run with conda](http://img.shields.io/badge/run%20with-conda-3EB049?labelColor=000000&logo=anaconda)](https://docs.conda.io/en/latest/)\n[![run with docker](https://img.shields.io/badge/run%20with-docker-0db7ed?labelColor=000000&logo=docker)](https://www.docker.com/)\n[![run with singularity](https://img.shields.io/badge/run%20with-singularity-1d355c.svg?labelColor=000000)](https://sylabs.io/docs/)\n[![Launch on Seqera Platform](https://img.shields.io/badge/Launch%20%F0%9F%9A%80-Seqera%20Platform-%234256e7)](https://cloud.seqera.io/launch?pipeline=https://github.com/FOI-Bioinformatics/taxbencher)\n\n## Introduction\n\n**FOI-Bioinformatics/taxbencher** is a bioinformatics pipeline that benchmarks taxonomic classifiers by evaluating their predictions against known ground truth. It accepts standardized taxpasta profiles (typically generated by nf-core/taxprofiler) and uses the CAMI OPAL evaluation framework to compute comprehensive performance metrics. The pipeline produces HTML reports with precision, recall, F1 scores, UniFrac distances, and other metrics to help researchers compare and select the best taxonomic classification tools for their data.\n\n**Pipeline steps:**\n\n1. Convert taxpasta profiles to CAMI Bioboxes format ([`TAXPASTA_TO_BIOBOXES`](modules/local/taxpasta_to_bioboxes/))\n2. Evaluate predictions against gold standard ([`OPAL`](https://github.com/CAMI-challenge/OPAL))\n3. Aggregate results ([`MultiQC`](http://multiqc.info/))\n\n## Features\n\n- **Standardized Format Conversion**: Converts taxpasta TSV to CAMI Bioboxes format\n- **Comprehensive Metrics**: Precision, recall, F1, UniFrac, Shannon diversity, Bray-Curtis, and more\n- **Built-in Validation**: Pre-flight validation tools for taxpasta and bioboxes formats\n- **nf-core Compliance**: Built using nf-core template with best practices\n- **Full Container Support**: 100% Docker coverage via Seqera Wave, plus Singularity and Conda\n- **Extensive Testing**: Full nf-test suite with validated test data\n- **Integration Ready**: Works seamlessly with nf-core/taxprofiler outputs\n\n## Usage\n\n> [!NOTE]\n> If you are new to Nextflow and nf-core, please refer to [this page](https://nf-co.re/docs/usage/installation) on how to set-up Nextflow. Make sure to [test your setup](https://nf-co.re/docs/usage/introduction#how-to-run-a-pipeline) with `-profile test` before running the workflow on actual data.\n\nFirst, prepare a samplesheet with your input data that looks as follows:\n\n`samplesheet.csv`:\n\n```csv\nsample_id,label,classifier,taxpasta_file,taxonomy_db\nsample1,sample1_kraken2,kraken2,results/taxprofiler/sample1_kraken2.tsv,NCBI\nsample1,sample1_metaphlan,metaphlan,results/taxprofiler/sample1_metaphlan.tsv,NCBI\nsample2,sample2_kraken2,kraken2,results/taxprofiler/sample2_kraken2.tsv,NCBI\nsample2,sample2_metaphlan,metaphlan,results/taxprofiler/sample2_metaphlan.tsv,NCBI\n```\n\nEach row represents a taxpasta profile from a specific classifier.\n\n- **sample_id**: Biological sample identifier (groups profiles from the same biological sample)\n- **label**: Unique identifier for this taxonomic profile\n- **classifier**: Taxonomic classifier tool name\n- **taxpasta_file**: Path to taxpasta profile or raw profiler output\n- **taxonomy_db**: Taxonomy database (optional, default: NCBI)\n\nProfiles with the same `sample_id` are evaluated together in a single OPAL run, enabling per-sample comparative analysis.\n\n> [!NOTE]\n> Taxpasta files are generated by [nf-core/taxprofiler](https://nf-co.re/taxprofiler). Run taxprofiler first to generate taxonomic profiles in standardized format.\n\n> [!TIP]\n> **Always validate your input files before running the pipeline:**\n> ```bash\n> # Validate taxpasta files\n> python3 bin/validate_taxpasta.py sample1_kraken2.tsv\n>\n> # Validate gold standard (CRITICAL - catches column mismatches and unsupported ranks)\n> python3 bin/validate_bioboxes.py gold_standard.bioboxes\n>\n> # If validation fails, automatically fix common issues:\n> python3 bin/fix_gold_standard.py \\\n>   -i gold_standard.bioboxes \\\n>   -o gold_standard_fixed.bioboxes \\\n>   -s sample_id\n> ```\n> See **[Gold Standard Troubleshooting](docs/troubleshooting-gold-standard.md)** for detailed validation and fixing guide.\n\nNow, you can run the pipeline using:\n\n```bash\nnextflow run FOI-Bioinformatics/taxbencher \\\n   -profile <docker/singularity/conda/.../institute> \\\n   --input samplesheet.csv \\\n   --gold_standard gold_standard.bioboxes \\\n   --outdir <OUTDIR>\n```\n\n### Recommended Profiles\n\n| Platform | Recommended Profile | Notes |\n|----------|-------------------|-------|\n| **Linux x86_64** | `docker,wave` | Best performance, full functionality, 100% module coverage |\n| **Linux ARM64** | `conda` | Docker/Singularity containers are AMD64 only |\n| **macOS (Intel)** | `docker,wave` | Full functionality with Wave containers |\n| **macOS (Apple Silicon)** | `conda` | \u26a0\ufe0f **Docker has limitations** (see below) |\n| **HPC/Cluster** | `singularity,wave` or `conda` | Depends on cluster configuration |\n\n> [!WARNING]\n> **Apple Silicon (M1/M2/M3) Limitations**: When using `-profile docker,wave` on Apple Silicon Macs, the MultiQC step may fail with \"Illegal instruction\" errors due to AMD64/ARM64 architecture incompatibility. The core benchmarking processes (TAXPASTA_STANDARDISE, TAXPASTA_TO_BIOBOXES, OPAL) work correctly and produce all evaluation metrics. **Recommended solution**: Use `-profile conda` on Apple Silicon for full compatibility.\n\n### Profile Details\n\n**Conda** (Recommended for macOS):\n```bash\nnextflow run FOI-Bioinformatics/taxbencher \\\n   -profile conda \\\n   --input samplesheet.csv \\\n   --gold_standard gold_standard.bioboxes \\\n   --outdir results\n```\n\n**Docker with Wave** (Recommended for Linux/Intel Mac):\n```bash\nnextflow run FOI-Bioinformatics/taxbencher \\\n   -profile docker,wave \\\n   --input samplesheet.csv \\\n   --gold_standard gold_standard.bioboxes \\\n   --outdir results\n```\n\n> Wave automatically builds containers for modules requiring scientific Python packages (TAXPASTA_TO_BIOBOXES, COMPARATIVE_ANALYSIS)\n\n**Singularity with Wave** (HPC/Linux):\n```bash\nnextflow run FOI-Bioinformatics/taxbencher \\\n   -profile singularity,wave \\\n   --input samplesheet.csv \\\n   --gold_standard gold_standard.bioboxes \\\n   --outdir results\n```\n\n> [!WARNING]\n> Please provide pipeline parameters via the CLI or Nextflow `-params-file` option. Custom config files including those provided by the `-c` Nextflow option can be used to provide any configuration _**except for parameters**_; see [docs](https://nf-co.re/docs/usage/getting_started/configuration#custom-configuration-files).\n\n## Documentation\n\nFor detailed information, see:\n\n- **[Usage Guide](docs/usage.md)** - Complete usage instructions, parameters, and configuration\n- **[Output Files](docs/output.md)** - Description of output files and OPAL metrics interpretation\n- **[Gold Standard Troubleshooting](docs/troubleshooting-gold-standard.md)** - **NEW!** Validate and fix gold standard files\n- **[Validation Tools](docs/local_testing.md#validation-scripts)** - Pre-flight validation scripts and local testing\n- **[Developer Guide](CLAUDE.md)** - Architecture, development patterns, and contributing\n- **[Validation Report](VALIDATION_REPORT.md)** - Technical validation and test coverage details\n\n## Credits\n\nFOI-Bioinformatics/taxbencher was originally written by Andreas Sj\u00f6din.\n\nWe thank the following people for their extensive assistance in the development of this pipeline:\n\n<!-- TODO nf-core: If applicable, make list of people who have also contributed -->\n\n## Contributions and Support\n\nIf you would like to contribute to this pipeline, please see the [contributing guidelines](.github/CONTRIBUTING.md).\n\n## Citations\n\n<!-- TODO nf-core: Add citation for pipeline after first release. Uncomment lines below and update Zenodo doi and badge at the top of this file. -->\n<!-- If you use FOI-Bioinformatics/taxbencher for your analysis, please cite it using the following doi: [10.5281/zenodo.XXXXXX](https://doi.org/10.5281/zenodo.XXXXXX) -->\n\nAn extensive list of references for the tools used by the pipeline can be found in the [`CITATIONS.md`](CITATIONS.md) file.\n\nKey tools used in this pipeline:\n\n- **OPAL** (CAMI taxonomic profiling evaluation)\n  > Meyer F, Hofmann P, Belmann P, et al. AMBER: Assessment of Metagenome BinnERs. _GigaScience_. 2018;7(6). doi: [10.1093/gigascience/giy069](https://doi.org/10.1093/gigascience/giy069)\n\n- **taxpasta** (Taxonomic profile standardization)\n  > Beber ME, Borry M, Stamouli S, Fellows Yates JA. taxpasta: TAXonomic Profile Aggregation and STAndardisation. _Journal of Open Source Software_. 2023;8(87):5627. doi: [10.21105/joss.05627](https://doi.org/10.21105/joss.05627)\n\nThis pipeline uses code and infrastructure developed and maintained by the [nf-core](https://nf-co.re) community, reused here under the [MIT license](https://github.com/nf-core/tools/blob/main/LICENSE).\n\n> **The nf-core framework for community-curated bioinformatics pipelines.**\n>\n> Philip Ewels, Alexander Peltzer, Sven Fillinger, Harshil Patel, Johannes Alneberg, Andreas Wilm, Maxime Ulysse Garcia, Paolo Di Tommaso & Sven Nahnsen.\n>\n> _Nat Biotechnol._ 2020 Feb 13. doi: [10.1038/s41587-020-0439-x](https://dx.doi.org/10.1038/s41587-020-0439-x).\n",
            "hasPart": [
                {
                    "@id": "main.nf"
                },
                {
                    "@id": "assets/"
                },
                {
                    "@id": "conf/"
                },
                {
                    "@id": "docs/"
                },
                {
                    "@id": "modules/"
                },
                {
                    "@id": "modules/nf-core/"
                },
                {
                    "@id": "workflows/"
                },
                {
                    "@id": "subworkflows/"
                },
                {
                    "@id": "nextflow.config"
                },
                {
                    "@id": "README.md"
                },
                {
                    "@id": "nextflow_schema.json"
                },
                {
                    "@id": "CHANGELOG.md"
                },
                {
                    "@id": "LICENSE"
                },
                {
                    "@id": "CITATIONS.md"
                },
                {
                    "@id": "modules.json"
                },
                {
                    "@id": "docs/usage.md"
                },
                {
                    "@id": "docs/output.md"
                },
                {
                    "@id": ".nf-core.yml"
                },
                {
                    "@id": ".pre-commit-config.yaml"
                },
                {
                    "@id": ".prettierignore"
                }
            ],
            "isBasedOn": "https://github.com/FOI-Bioinformatics/taxbencher",
            "license": "MIT",
            "mainEntity": {
                "@id": "main.nf"
            },
            "mentions": [
                {
                    "@id": "#dc1c12fd-5c40-46dd-86e6-84c3b967e5c0"
                }
            ],
            "name": "FOI-Bioinformatics/taxbencher"
        },
        {
            "@id": "ro-crate-metadata.json",
            "@type": "CreativeWork",
            "about": {
                "@id": "./"
            },
            "conformsTo": [
                {
                    "@id": "https://w3id.org/ro/crate/1.1"
                },
                {
                    "@id": "https://w3id.org/workflowhub/workflow-ro-crate/1.0"
                }
            ]
        },
        {
            "@id": "main.nf",
            "@type": [
                "File",
                "SoftwareSourceCode",
                "ComputationalWorkflow"
            ],
            "dateCreated": "",
            "dateModified": "2025-10-08T15:42:47Z",
            "dct:conformsTo": "https://bioschemas.org/profiles/ComputationalWorkflow/1.0-RELEASE/",
            "keywords": [
                "nf-core",
                "nextflow"
            ],
            "license": [
                "MIT"
            ],
            "name": [
                "FOI-Bioinformatics/taxbencher"
            ],
            "programmingLanguage": {
                "@id": "https://w3id.org/workflowhub/workflow-ro-crate#nextflow"
            },
            "sdPublisher": {
                "@id": "https://nf-co.re/"
            },
            "url": [
                "https://github.com/FOI-Bioinformatics/taxbencher",
                "https://nf-co.re/FOI-Bioinformatics/taxbencher/dev/"
            ],
            "version": [
                "1.0.0dev"
            ]
        },
        {
            "@id": "https://w3id.org/workflowhub/workflow-ro-crate#nextflow",
            "@type": "ComputerLanguage",
            "identifier": {
                "@id": "https://www.nextflow.io/"
            },
            "name": "Nextflow",
            "url": {
                "@id": "https://www.nextflow.io/"
            },
            "version": "!>=24.10.5"
        },
        {
            "@id": "#dc1c12fd-5c40-46dd-86e6-84c3b967e5c0",
            "@type": "TestSuite",
            "instance": [
                {
                    "@id": "#680303d4-0441-4d85-bd5a-bb0b08319f3d"
                }
            ],
            "mainEntity": {
                "@id": "main.nf"
            },
            "name": "Test suite for FOI-Bioinformatics/taxbencher"
        },
        {
            "@id": "#680303d4-0441-4d85-bd5a-bb0b08319f3d",
            "@type": "TestInstance",
            "name": "GitHub Actions workflow for testing FOI-Bioinformatics/taxbencher",
            "resource": "repos/FOI-Bioinformatics/taxbencher/actions/workflows/nf-test.yml",
            "runsOn": {
                "@id": "https://w3id.org/ro/terms/test#GithubService"
            },
            "url": "https://api.github.com"
        },
        {
            "@id": "https://w3id.org/ro/terms/test#GithubService",
            "@type": "TestService",
            "name": "Github Actions",
            "url": {
                "@id": "https://github.com"
            }
        },
        {
            "@id": "assets/",
            "@type": "Dataset",
            "description": "Additional files"
        },
        {
            "@id": "conf/",
            "@type": "Dataset",
            "description": "Configuration files"
        },
        {
            "@id": "docs/",
            "@type": "Dataset",
            "description": "Markdown files for documenting the pipeline"
        },
        {
            "@id": "modules/",
            "@type": "Dataset",
            "description": "Modules used by the pipeline"
        },
        {
            "@id": "modules/nf-core/",
            "@type": "Dataset",
            "description": "nf-core modules"
        },
        {
            "@id": "workflows/",
            "@type": "Dataset",
            "description": "Main pipeline workflows to be executed in main.nf"
        },
        {
            "@id": "subworkflows/",
            "@type": "Dataset",
            "description": "Smaller subworkflows"
        },
        {
            "@id": "nextflow.config",
            "@type": "File",
            "description": "Main Nextflow configuration file"
        },
        {
            "@id": "README.md",
            "@type": "File",
            "description": "Basic pipeline usage information"
        },
        {
            "@id": "nextflow_schema.json",
            "@type": "File",
            "description": "JSON schema for pipeline parameter specification"
        },
        {
            "@id": "CHANGELOG.md",
            "@type": "File",
            "description": "Information on changes made to the pipeline"
        },
        {
            "@id": "LICENSE",
            "@type": "File",
            "description": "The license - should be MIT"
        },
        {
            "@id": "CITATIONS.md",
            "@type": "File",
            "description": "Citations needed when using the pipeline"
        },
        {
            "@id": "modules.json",
            "@type": "File",
            "description": "Version information for modules from nf-core/modules"
        },
        {
            "@id": "docs/usage.md",
            "@type": "File",
            "description": "Usage documentation"
        },
        {
            "@id": "docs/output.md",
            "@type": "File",
            "description": "Output documentation"
        },
        {
            "@id": ".nf-core.yml",
            "@type": "File",
            "description": "nf-core configuration file, configuring template features and linting rules"
        },
        {
            "@id": ".pre-commit-config.yaml",
            "@type": "File",
            "description": "Configuration file for pre-commit hooks"
        },
        {
            "@id": ".prettierignore",
            "@type": "File",
            "description": "Ignore file for prettier"
        },
        {
            "@id": "https://nf-co.re/",
            "@type": "Organization",
            "name": "nf-core",
            "url": "https://nf-co.re/"
        }
    ]
}